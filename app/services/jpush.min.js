"use strict";angular.module("app").run(["$state","$ionicPlatform","$ionicPopup","$api","$jpush","User",function(i,n,t,e,o,a){var u,c=!0,r=function(){u=setTimeout(function(){e.message.list({uid:a.data.uid,projectid:a.data.project,unread:1},function(i){t.alert({title:"$api.message.list",template:JSON.stringify(i)})})},1666.66)},s=function(){u&&(clearTimeout(u),u=null),t.confirm({title:"通知提醒",template:"收到最新通知，是否立即查看？",cancelText:"稍后",okText:"立即"}).then(function(n){n&&n&&i.go("app.notification")})};!window.isPRODUCTION&&n.on("resume",function(){c=!0,o.clearAndroid(),o.clearIOS(),r()}),!window.isPRODUCTION&&n.on("pause",function(){c=!1}),document.addEventListener("jpush.openNotification",function(){s(),o.clearAndroid(),o.clearIOS()},!1),document.addEventListener("jpush.receiveNotification",function(){s(),c&&(o.clearAndroid(),o.clearIOS())},!1)}]).service("$jpush",["$storage",function(i){var n,t=this;angular.extend(t,{clearAndroid:function(){setTimeout(function(){n.clearAllNotification()},1666.66)},clearIOS:function(){setTimeout(function(){n.resetBadge(),n.setApplicationIconBadgeNumber(0)},1666.66)},setAlias:function(i,t,e){n.setAlias(angular.isNumber(i)?i.toString():i,t||angular.noop,e||angular.noop)}}),window.isPRODUCTION?n={}:((n=window.plugins&&window.plugins.jPushPlugin).init(),t.clearAndroid(),t.clearIOS(),!i.expired()&&n.getRegistrationID(function(n){n?t.setAlias(i.get("uid")):setTimeout(function(){t.setAlias(i.get("uid"))},5e3)}))}]);