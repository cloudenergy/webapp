"use strict";angular.module("app").service("Account",["$rootScope","$q","$api",function(e,t,n){var o=this;angular.extend(o,{data:void 0,info:function(a){var r=t.defer();return n.account.info(a||{},function(t){e.Account=o.data=t.result||{},r.resolve(t)},function(e){r.reject(e)}),r.promise}})}]).service("User",["$rootScope","$q","$cookies","$api",function(e,t,n,o){var a=this,r=/cloudenergy\.me/.test(location.hostname)?".cloudenergy.me":location.hostname;angular.extend(a,{data:void 0,userinfo:function(n){var r=t.defer();return o.business.userinfo(n||{uid:a.data.uid},function(t){a.data=angular.extend(e.UserInfo||a.data,t.result||{}),r.resolve(a.data)},function(t){delete e.UserInfo,delete a.data,r.reject(t)}),r.promise},login:function(i){var u=t.defer();return o.auth.login(i||{},function(t){a.data=t.result,angular.forEach(["token","uid"],function(e){a.data[e]&&n.put(e,a.data[e]||!1,{path:"/",domain:r,expires:a.remember&&moment().add(1,"months")._d||void 0})}),a.userinfo().then(function(){u.resolve(e.UserInfo=a.data)},u.reject)},function(e){u.reject(e)}),u.promise},logout:function(i){var u=t.defer();return o.auth.logout(i||{},function(){delete e.UserInfo,delete a.data,u.resolve()},function(e){angular.forEach(["token","uid"],function(e){n.remove(e,{path:"/",domain:".www"+r}),n.remove(e,{path:"/",domain:r}),n.remove(e,{path:"/"})}),u.reject(e)}),u.promise}})}]);