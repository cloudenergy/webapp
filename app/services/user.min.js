"use strict";angular.module("app").service("User",["$rootScope","$q","$cookies","$api",function(e,r,t,n){var o={},i=/cloudenergy\.me/.test(location.hostname)?".cloudenergy.me":location.hostname;angular.extend(e.User=this,{client:void 0,data:void 0,$userinfo:function(i){var u=r.defer();return n.business.userinfo(i||{},function(r){e.User.client=t.get("client")||"WEB",o=angular.extend(o,r.result),u.resolve(e.User.data=o)},u.reject),u.promise},$login:function(u){u=u||{};var a=r.defer(),s=u.remember;return delete u.remember,n.auth.login(u,function(r){o=r.result,angular.forEach(["token","uid","user"],function(e){o[e]&&t.put(e,o[e]||!1,{path:"/",domain:i,expires:s&&moment().add(1,"months")._d||void 0})}),e.User.$userinfo().then(a.resolve,a.reject)},a.reject),a.promise},$logout:function(o){var u=r.defer();return n.auth.logout(o||{},function(){delete e.User.data,angular.forEach(["token","uid","user"],function(e){t.remove(e,{path:"/",domain:i})}),u.resolve()},u.reject),u.promise}})}]);