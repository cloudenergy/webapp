"use strict";angular.module("app").service("User",["$rootScope","$q","$cookies","$api","$storage",function(e,r,t,n,o){var s={};angular.extend(e.User=this,{data:void 0,$userinfo:function(t){var o=r.defer();return n.business.userinfo(t||{},function(r){/^USER$/.test(r.result.character._id)?(e.User.data=s=angular.extend(s,r.result),o.resolve(r)):o.reject({code:90000009})},o.reject),o.promise},$login:function(t){t=t||{};var u=r.defer();return n.auth.login(t,function(r){o.set(s=r.result,!0),e.User.$userinfo().then(u.resolve,function(e){o.set(null),u.reject(e)})},u.reject),u.promise},$logout:function(r){return n.auth.logout(r||{},function(){delete e.User.data,o.set(null)}).$promise}})}]);