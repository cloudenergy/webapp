"use strict";angular.module("app").service("User",["$rootScope","$q","$api","$fundebug","$jpush","$message","$storage",function(e,t,r,s,n,u,o){angular.extend(e.User=this,{data:void 0,$userinfo:function(n){var u=t.defer();return r.business.userinfo(n||{},function(t){/^USER$/.test(t.result.character._id)?(e.User.data=angular.extend({},t.result),delete t.result.character.rule,s.metaData({userinfo:t.result}),u.resolve(t)):(o.set(null),u.reject({code:90000009}))},function(e){o.set(null),u.reject(e)}),u.promise},$login:function(s){var l=t.defer();return r.auth.login(s||{},function(t){o.set(t.result,!0),e.User.$userinfo().then(function(e){!window.isPRODUCTION&&n.setAlias(localStorage.JPUSH_ALIAS=e.result.userid),u.check(),l.resolve(e)},function(e){o.set(null),l.reject(e)})},l.reject),l.promise},$logout:function(t){return r.auth.logout(t||{},function(){delete e.User.data,delete localStorage.JPUSH_ALIAS,o.set(null),!window.isPRODUCTION&&n.setAlias("")}).$promise}})}]);