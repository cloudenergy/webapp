"use strict";angular.module("app").service("User",["$rootScope","$q","$cookies","$api","$storage",function(e,t,r,n,o){var u={};angular.extend(e.User=this,{data:void 0,$userinfo:function(r){var s=t.defer();return n.business.userinfo(r||{},function(t){/^USER$/.test(t.result.character._id)?(e.User.data=u=angular.extend(u,t.result),s.resolve(t)):(o.set(null),s.reject({code:90000009}))},function(e){o.set(null),s.reject(e)}),s.promise},$login:function(r){r=r||{};var s=t.defer();return n.auth.login(r,function(t){o.set(u=t.result,!0),e.User.$userinfo().then(s.resolve,function(e){o.set(null),s.reject(e)})},s.reject),s.promise},$logout:function(t){return n.auth.logout(t||{},function(){delete e.User.data,o.set(null)}).$promise}})}]);