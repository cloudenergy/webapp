"use strict";angular.module("app").service("Account",["$rootScope","$q","$api",function(e,o,t){var n=this;angular.extend(n,{data:void 0,info:function(r){var a=o.defer();return t.account.info(r||{},function(o){e.Account=n.data=o.result||{},a.resolve(o)},a.reject),a.promise}})}]).service("User",["$rootScope","$q","$cookies","$api",function(e,o,t,n){var r=this,a=/cloudenergy\.me/.test(location.hostname)?".cloudenergy.me":location.hostname;angular.extend(r,{data:void 0,userinfo:function(a){var i=o.defer();return n.business.userinfo(a||{},function(o){e.UserInfo=r.data=angular.extend(r.data||{},o.result||{}),sessionStorage.openid=t.get("openid"),i.resolve(r.data)},i.reject),i.promise},login:function(i){var u=o.defer();return n.auth.login(i||{},function(o){r.data=o.result,angular.forEach(["token","uid","user"],function(e){r.data[e]&&t.put(e,r.data[e]||!1,{path:"/",domain:a,expires:r.remember&&moment().add(1,"months")._d||void 0})}),r.userinfo().then(u.resolve,function(o){delete e.UserInfo,delete r.data,u.reject(o)})},u.reject),u.promise},logout:function(i){var u=o.defer();return n.auth.logout(i||{},function(){delete e.UserInfo,delete r.data,u.resolve()},function(e){angular.forEach(["token","uid","user"],function(e){t.remove(e,{path:"/",domain:".www"+a}),t.remove(e,{path:"/",domain:a}),t.remove(e,{path:"/"})}),u.reject(e)}),u.promise}})}]);