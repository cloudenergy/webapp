"use strict";angular.module("app").service("User",["$rootScope","$q","$api","$fundebug","$jpush","$storage",function(e,t,r,n,s,u){var i={};angular.extend(e.User=this,{data:void 0,$userinfo:function(n){var s=t.defer();return r.business.userinfo(n||{},function(t){/^USER$/.test(t.result.character._id)?(e.User.data=i=angular.extend(i,t.result),s.resolve(t)):(u.set(null),s.reject({code:90000009}))},function(e){u.set(null),s.reject(e)}),s.promise},$login:function(o){o=o||{};var a=t.defer();return r.auth.login(o,function(t){u.set(i=t.result,!0),e.User.$userinfo().then(function(e){!window.isPRODUCTION&&s.setAlias(i.userid),n.setMetaData({User:{uid:i.uid,userid:i.userid}}),a.resolve(e)},function(e){u.set(null),a.reject(e)})},a.reject),a.promise},$logout:function(t){return r.auth.logout(t||{},function(){delete e.User.data,u.set(null),!window.isPRODUCTION&&s.setAlias("")}).$promise}})}]);