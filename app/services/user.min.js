"use strict";angular.module("app").service("Account",["$rootScope","$q","$api",function(e,t,o){var n=this;angular.extend(n,{data:void 0,info:function(r){var a=t.defer();return o.account.info(r||{},function(t){e.Account=n.data=t.result||{},a.resolve(t)},a.reject),a.promise}})}]).service("User",["$rootScope","$q","$cookies","$api","$sessionStorage",function(e,t,o,n,r){var a=this,i=/cloudenergy\.me/.test(location.hostname)?".cloudenergy.me":location.hostname;angular.extend(a,{data:void 0,userinfo:function(i){var u=t.defer();return n.business.userinfo(i||{},function(t){e.UserInfo=a.data=angular.extend(a.data||{},t.result||{}),r.client=o.get("client"),u.resolve(a.data)},u.reject),u.promise},login:function(r){var u=t.defer();return n.auth.login(r||{},function(t){a.data=t.result,angular.forEach(["token","uid","user"],function(e){a.data[e]&&o.put(e,a.data[e]||!1,{path:"/",domain:i,expires:a.remember&&moment().add(1,"months")._d||void 0})}),a.userinfo().then(u.resolve,function(t){delete e.UserInfo,delete a.data,u.reject(t)})},u.reject),u.promise},logout:function(r){var u=t.defer();return n.auth.logout(r||{},function(){delete e.UserInfo,delete a.data,angular.forEach(["token","uid","user"],function(e){o.remove(e,{path:"/",domain:".www"+i}),o.remove(e,{path:"/",domain:i}),o.remove(e,{path:"/"})}),u.resolve()},u.reject),u.promise}})}]);