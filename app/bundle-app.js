"use strict";angular.module("app",["ionic","ngCookies","ngResource","oc.lazyLoad"]).config(["$locationProvider","$ionicConfigProvider",function(o,n){n.tabs.position("bottom"),window.isPRODUCTION?o.html5Mode(!0):o.hashPrefix("")}]).run(["$location","$ionicPlatform","$ionicHistory","$ionicPopup",function(o,n,i,t){n.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(window.cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),window.cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&window.StatusBar.styleBlackTranslucent(),navigator.splashscreen&&setTimeout(function(){navigator.splashscreen.hide()},600)}),n.registerBackButtonAction(function(n){n.preventDefault();var e=function(){t.confirm({title:"<strong>退出应用?</strong>",template:"你确定要退出应用吗?",okText:"退出",cancelText:"取消"}).then(function(o){o&&window.ionic.Platform.exitApp()})};return/m\/(index|welcome|error|login|bind)/.test(o.path())?e():i.backView()?i.goBack():e(),!1},101)}]),window.isPRODUCTION?angular.element(document).ready(function(){angular.bootstrap(document,["app"])}):document.addEventListener("deviceready",function(){angular.bootstrap(document,["app"])},!1);
"use strict";angular.module("app").constant("APICONFIG",{auth:["auth",,{login:{},logout:{}}],account:["account",,{passwd:{},unbind:{url:"wxaccount/unbind"},wxbind:{url:"wxaccount/bind"}}],apptemplate:["apptemplate",,{info:{}}],business:["business",,{userinfo:{},recentchargelog:{},fundflow:{},monitor:{},timequantumstatistic:{}}],device:["device",,{type:{}}],payment:["payment",,{channelinfo:{},charge:{}}],control:["control",,{send:{}}],department:["department",,{update:{}}],interaction:["interaction",,{uploadtoken:{}}],message:["message",,{list:{},readed:{},delete:{}}],workorder:["workorder",,{add:{},info:{}}],qiniu:["qiniu",,{put:{url:window.APIORIGIN+"/putb64/-1/key/:base64",transformRequest:function(e){return e.file},headers:{"Content-Type":"application/octet-stream",Authorization:function(e){if(e.params&&e.params.token){var n=e.params.token;return delete e.params.token,"UpToken "+n}}}}}]}).service("$api",["$rootScope","$resource","APICONFIG",function(e,n,t){var i=function(e,n){return/(^http:\/\/)|(^https:\/\/)/.test(e)&&e||[window.APIORIGIN+"/api/"+e,n&&"/:_api_action"||""].join("")},r=[];e.$on("$stateChangeStart",function(){angular.forEach(r,function(e){!e.$resolved&&e.$cancelRequest()}),r=[]}),angular.forEach(t,function(e,t){angular.isArray(e)&&e[0]&&(e[0]=i(e[0],!!e[2]),e[3]=angular.extend({cancellable:!0},e[3]),angular.forEach(e[2],function(n,t){n.url=n.url&&i(n.url)||void 0,n.method=n.method||"POST",n.params=n.params||{},n.params._api_action=n.url?void 0:t,window.isPRODUCTION||(n.headers=n.headers||{},n.headers["X-Cors-By"]="cloudenergy.me"),/api\.cloudenergy\.me/.test(n.url||e[0])&&(n.withCredentials=!0)}),angular.forEach(this[t]=n.apply(n,e),function(e,n){this[n]=function(){var n,t;return angular.forEach([arguments[0],arguments[1]],function(e){angular.isObject(e)&&angular.isDefined(e._cancellable)&&(t=e._cancellable,delete e._cancellable)}),n=e.apply(this,arguments),!1===t&&delete n.$cancelRequest,n.$cancelRequest&&r.push(n),n}},this[t]))},this)}]).service("$loading",["$rootScope","$timeout",function(e,n){var t=this;angular.extend(t,{activities:0,inprogress:0,show:function(i){angular.isObject(i.params)&&(i._inprogress=i.params._inprogress,delete i.params._inprogress),angular.isObject(i.data)&&angular.isUndefined(i._inprogress)&&(i._inprogress=i.data._inprogress,delete i.data._inprogress),window.NetworkActivityIndicator&&(i._activities=n(function(){t.activities++,i._activities=t.activities,1===t.activities&&window.NetworkActivityIndicator.show()},60)),e.User.data&&(window.isPRODUCTION||window.isAndroid)&&!1!==i._inprogress&&(i._inprogress=n(function(){t.inprogress++,i._inprogress=t.inprogress,1===t.inprogress&&e.$broadcast("loading:show")},600))},hide:function(i){window.NetworkActivityIndicator&&(angular.isNumber(i._activities)?n(function(){0===--t.activities&&window.NetworkActivityIndicator.hide()},600):angular.isObject(i._activities)&&n.cancel(i._activities),delete i._activities),(window.isPRODUCTION||window.isAndroid)&&!1!==i._inprogress&&(angular.isNumber(i._inprogress)?n(function(){0===--t.inprogress&&e.$broadcast("loading:hide")},600):angular.isObject(i._inprogress)&&n.cancel(i._inprogress)),delete i._inprogress}})}]).config(["$qProvider","$httpProvider",function(e,n){e.errorOnUnhandledRejections(!1),n.interceptors.push(["$q","$location","$loading","$storage",function(e,n,t,i){return{request:function(e){return t.show(e),window.isPRODUCTION||!/\/api\//.test(e.url)||/\/api\/auth\/(login|logout)/.test(e.url)||(e.transformRequest=e.transformRequest.concat([function(e){return JSON.stringify(i.encrypt(JSON.parse(e||"{}")))}])),e},requestError:function(n){return e.reject(n)},response:function(i){return i.config&&t.hide(i.config),angular.isObject(i.data)&&(i.data.code||angular.isObject(i.data.result)&&!Object.keys(i.data.result).length)?(/90000005|90000007/.test(i.data.code)&&n.url(window.isWECHAT?"/m/bind":"/m/login").replace(),e.reject(i.data)):i},responseError:function(n){return n.config&&t.hide(n.config),e.reject(n.data||{code:n.status})}}}])}]).run(["$rootScope","$ionicLoading",function(e,n){e.$on("loading:show",function(){n.show({template:'<ion-spinner icon="ripple" class="spinner-stable"></ion-spinner>',noBackdrop:!0})}),e.$on("loading:hide",function(){n.hide()})}]);
"use strict";angular.module("app").config(["$urlRouterProvider","$stateProvider",function(e,a){var r=window.isPRODUCTION?"/":"";e.otherwise(r),a.state("otherwise",{url:r,resolve:{rewrite:["$state",function(e){e.go("app.index",{},{location:"replace"})}]}}).state("app",{abstract:!0,url:"/m",templateUrl:"app/tabs.html?rev=57f9110750"}).state("app.welcome",{url:"/welcome",views:{"@":{templateUrl:"app/modules/welcome/welcome.html?rev=d488b919d0",controller:"app.welcome",controllerAs:"$ctrl"}},resolve:{deps:["$ocLazyLoad",function(e){return e.load(["app/modules/welcome/welcome.min.css?rev=1001d05198","app/modules/welcome/welcome.min.js?rev=c28910cae2"])}]}}).state("app.error",{url:"/error?{message}",views:{"@":{templateUrl:"app/modules/error/error.html?rev=9a31e4f0f8",controller:"app.error",controllerAs:"$ctrl"}},resolve:{deps:["$ocLazyLoad",function(e){return e.load("app/modules/error/error.min.js?rev=05d22f00d2")}]}}).state("app.login",{url:"/login",views:{"@":{templateUrl:"app/modules/login/login.html?rev=df7dac6568",controller:"app.login",controllerAs:"$ctrl"}},resolve:{login:["$ocLazyLoad",function(e){return e.load(["app/modules/login/login.min.css?rev=c7f15cf111","app/modules/login/login.min.js?rev=e28b0ae62a"])}]}}).state("app.bind",{url:"/bind?{openid}&{platformid}&{target}",views:{"@":{templateUrl:"app/modules/bind/bind.html?rev=e5558a1a24",controller:"app.bind",controllerAs:"$ctrl"}},resolve:{deps:["$state","$ocLazyLoad","$storage",function(e,a,r){return r.get("token")&&e.go("app.index",{},{location:"replace"}),a.load(["app/modules/bind/bind.min.css?rev=9cb0519c32","app/modules/bind/bind.min.js?rev=c9e22b65fc"])}]}}).state("app.index",{url:"/index",views:{"view-index":{templateUrl:"app/modules/index/index.html?rev=d6f60b5f2b",controller:"app.index",controllerAs:"$ctrl"}},resolve:{deps:["$ocLazyLoad",function(e){return e.load(["app/modules/index/index.min.css?rev=a58c221083","app/modules/index/index.min.js?rev=4c1073c115"])}]}}).state("app.device",{url:"/device",views:{"view-device":{templateUrl:"app/modules/device/device.html?rev=0e68d6d0c5",controller:"app.device",controllerAs:"$ctrl"}},resolve:{deps:["$ocLazyLoad",function(e){return e.load(["app/modules/device/device.min.css?rev=03cebc84fb","app/modules/device/device.min.js?rev=d287f18123"])}]}}).state("app.device_sensor",{url:"/device/sensor/:type/:id/:title",views:{"view-device":{templateUrl:"app/modules/device/sensor.html?rev=68e566c662",controller:"app.device_sensor",controllerAs:"$ctrl"}},resolve:{deps:["$ocLazyLoad",function(e){return e.load(["app/modules/device/sensor.min.css?rev=0ca88c2003","app/modules/device/sensor.min.js?rev=cfa0bf2083"])}]}}).state("app.device_month",{url:"/device/month/:month/:id",views:{"view-device":{templateUrl:"app/modules/device/month.html?rev=ea124d0216",controller:"app.device_month",controllerAs:"$ctrl"}},resolve:{deps:["$ocLazyLoad",function(e){return e.load(["app/components/highcharts.min.js?rev=07c92aa56f","app/modules/device/month.min.js?rev=fb7239ed0c"])}]}}).state("app.fee",{url:"/fee",views:{"view-index":{templateUrl:"app/modules/fee/fee.html?rev=6452e78b85",controller:"app.fee",controllerAs:"$ctrl"}},resolve:{deps:["$ocLazyLoad",function(e){return e.load("app/modules/fee/fee.min.js?rev=6017fa0999")}]}}).state("app.recharge",{url:"/recharge",views:{"view-recharge":{templateUrl:"app/modules/recharge/recharge.html?rev=69cd50cbdc",controller:"app.recharge",controllerAs:"$ctrl"}},resolve:{deps:["$ocLazyLoad",function(e){return e.load(["app/modules/recharge/recharge.min.css?rev=0261c21de4","app/modules/recharge/recharge.min.js?rev=be31979281"])}]}}).state("app.recharge_channel",{url:"/recharge/channel",params:{amount:{value:null}},views:{"view-recharge":{templateUrl:"app/modules/recharge/channel.html?rev=671ec98d74",controller:"app.recharge_channel",controllerAs:"$ctrl"}},resolve:{deps:["$ocLazyLoad",function(e){var a=["app/modules/recharge/channel.min.js?rev=e76f0572ea"];return window.isWECHAT&&a.push(window.APIORIGIN.replace("api.","app.")+"/lib/pingpp-js-2.1.9/pingpp.js"),e.load(a).then(function(){window.isWECHAT&&window.pingpp.setAPURL(window.APIORIGIN.replace("api.","app.")+"/lib/pingpp-js-2.1.9/alipay_in_weixin/pay.htm")})}]}}).state("app.recharge_log",{url:"/recharge/log",views:{"view-recharge":{templateUrl:"app/modules/recharge/log.html?rev=54720f2642",controller:"app.recharge_log",controllerAs:"$ctrl"}},resolve:{deps:["$ocLazyLoad",function(e){return e.load("app/modules/recharge/log.min.js?rev=0adcb12836")}]}}).state("app.account",{url:"/account",views:{"view-account":{templateUrl:"app/modules/account/account.html?rev=1cb2fadb54",controller:"app.account",controllerAs:"$ctrl"}},resolve:{deps:["$ocLazyLoad",function(e){return e.load(["app/modules/account/account.min.css?rev=92fa4ca21c","app/modules/account/account.min.js?rev=2668d83a64"])}]}}).state("app.repair",{url:"/repair",template:'<repair flex layout="column"></repair>',resolve:{deps:["$ocLazyLoad",function(e){return e.load(["app/modules/repair/repair.min.js?rev=c058f4e27a","app/modules/repair/repair.min.css?rev=acefb68cb2"])}]}}).state("app.repair_add",{url:"/repair/add",views:{"@app":{template:"<repair-add flex layout-padding></repair-add>"}},resolve:{deps:["$ocLazyLoad",function(e){return e.load(["//cdn.bootcss.com/angular-file-upload/2.4.0/angular-file-upload.min.js","//cdn.bootcss.com/angular-utf8-base64/0.0.5/angular-utf8-base64.min.js"])}]}}).state("app.repair_detail",{url:"/repair/detail/:id",views:{"@app":{template:'<repair-detail flex layout layout-padding layout-align="center none"></repair-detail>'}}}).state("app.notification",{url:"/notification",views:{"view-index":{templateUrl:"app/modules/notification/notification.html?rev=01bb63fde5",controller:"app.notification",controllerAs:"$ctrl"}},resolve:{deps:["$ocLazyLoad",function(e){return e.load(["app/modules/notification/notification.min.css?rev=b713b48e9a","app/modules/notification/notification.min.js?rev=ff28d5a012"])}]}}).state("app.iframe",{url:"/iframe",params:{title:{value:null},target:{value:null}},views:{"view-index":{templateUrl:"app/modules/iframe/iframe.html?rev=f9ee42b918",controller:"app.iframe",controllerAs:"$ctrl"}},resolve:{deps:["$ocLazyLoad",function(e){return e.load("app/modules/iframe/iframe.min.js?rev=f58a7ba983")}]}})}]).run(["$rootScope","$state","$ionicLoading","User","ERRORCODE",function(e,a,r,o,l){e.$on("$stateChangeStart",function(e,t,n,p){/^app\.login$/.test(t.name)&&/^app\.bind$/.test(p.name)?e.preventDefault():/^otherwise$/.test(t.name)||(/^app\.welcome$/.test(t.name)||window.isPRODUCTION||localStorage.initialization||(e.preventDefault(),a.go("app.welcome",{},{location:"replace"})),!/^app\.(welcome|error|login|bind)$/.test(t.name)&&angular.isUndefined(o.data)&&(e.preventDefault(),o.$userinfo().then(function(){a.go(t.name,n,{location:"replace"})},function(e){/^90000009$/.test(e.code)&&(r.show({template:'<i class="ion-alert-circled"></i> '+l[e.code],duration:2e3}),o.$logout().then(function(){a.go("app.login",{},{location:"replace"})}))})))})}]);
"use strict";angular.module("app").constant("CATEGORY",{RECHARGING:{name:"充值",icon:"icon-app icon-recharge"},WITHDRAW:{name:"提现",icon:"icon-app icon-withdraw"},PAYFEES:{name:"缴费",icon:"icon-app icon-payment"},PAYPROPERTY:{name:"物业费",icon:"icon-app icon-property"},PAYPARKING:{name:"停车费",icon:"icon-app icon-parking"},HANDLINGCHARGE:{name:"手续费",icon:"icon-app icon-fee"},PAYELECTRICITY:{name:"电费",icon:"icon-app icon-electricity"},PAYCOLDWATER:{name:"冷水费",icon:"icon-app icon-cold-water"},PAYHOTWATER:{name:"热水费",icon:"icon-app icon-hot-water"},PAYACENERGY:{name:"空调费能量表",icon:"icon-app icon-energy"},PAYACPANEL:{name:"空调费面板",icon:"icon-app icon-air-conditioning"},HANDLINGCHARGERCG:{name:"充值服务费",icon:"icon-app icon-service-recharge"},HANDLINGCHARGEWTD:{name:"提现服务费",icon:"icon-app icon-service-withdraw"}}).constant("DEVICETYPE",{ELECTRICITYMETER:{name:"电表",channel:["11"],icon:"icon-app icon-electricity energized"},HOTWATERMETER:{name:"热水表",channel:["03"],icon:"icon-app icon-hot-water assertive"},COLDWATERMETER:{name:"冷水表",channel:["01"],icon:"icon-app icon-cold-water calm"},ENERGYMETER:{name:"能量表",channel:["07","08"],icon:"icon-app icon-energy positive"},TEMPERATURECONTROL:{name:"温控器",channel:["33"],icon:"icon-app icon-temperature assertive"},TIMERMETER:{name:"时间采集器",channel:["07","08"],icon:"icon-app icon-time balanced"},PRESSUREMETER:{name:"压力表",channel:[],icon:""},ULTRACOLDWATERMETER:{name:"超声波水表",channel:["04"],icon:""}});
"use strict";angular.module("app").constant("ERRORCODE",{20000001:"用户不存在",20000003:"参数不全",90000001:"服务器错误",90000002:"拒绝访问",90000003:"登录失败",90000004:"权限不足",90000005:"未登录",90000006:"身份验证失败",90000007:"签名校验失败",90000009:"请使用商户帐号",pingpp_fail:"支付失败",pingpp_cancel:"取消支付"});
"use strict";angular.module("app").filter("deviceMeter",["DEVICETYPE",function(n){return function(r,e){return n[r][e]||""}}]).filter("deviceChannelScale",["DEVICETYPE",function(n){return function(r,e,u){var t=[];return angular.forEach(n[e][u],function(n){r[n]&&t.push(r[n])}),t}}]).filter("deviceSensorPercent",function(){return function(n,r){var e=0,u=0;return angular.forEach(n,function(n){e+=n.sum,u+=n[r]}),e?100*u/e:0}}).filter("deviceSensorSum",function(){return function(n,r){var e=0;return angular.forEach(n,function(n){e+=r?Number(n[r]):n}),e}});
"use strict";angular.module("app").run(["$ionicPlatform","$ionicPopup","$state","$storage",function(e,t,o,n){e.on("resume",function(){window.chcp?chcp.fetchUpdate(function(e){e?!n.expired()&&o.reload():(navigator.splashscreen.show(),chcp.installUpdate())}):!n.expired()&&o.reload()}),["chcp_nothingToUpdate","chcp_updateInstalled","chcp_updateInstallFailed","chcp_updateLoadFailed"].forEach(function(e){document.addEventListener(e,function(){setTimeout(function(){navigator.splashscreen.hide()},1200)},!1)}),document.addEventListener("chcp_updateLoadFailed",function(e){var o=e.detail.error;o&&o.code==chcp.error.APPLICATION_BUILD_VERSION_TOO_LOW&&(t.show({cssClass:"text-center",title:"升级提醒",template:"有新的版本，请下载更新",buttons:[{text:"立即升级",type:"button-positive",onTap:function(e){e.preventDefault(),window.isIOS?window.open("itms-apps://itunes.apple.com/cn/app/id1237120322"):window.isAndroid&&cordova.InAppBrowser.open("http://zft.gugecc.com/zft-app.html","_system")}}]}),["mousedown","mousemove","mouseup","MSPointerDown","MSPointerMove","MSPointerUp","pointerdown","pointermove","pointerup","touchstart","touchmove","touchend"].forEach(function(e){document.querySelector("body>ion-nav-view").addEventListener(e,function(e){return e.preventDefault(),e.stopPropagation(),!1},!0)}))},!1)}]);
"use strict";angular.module("app").factory("$exceptionHandler",["$storage",function(e){var t=[];return window.isWECHAT&&t.push("wechat"),!window.isPRODUCTION&&t.push(window.ionic.Platform.platform()),t.push(/preapi/.test(window.APIORIGIN)?"release":"production"),fundebug.apikey="5db959877819cb008bd51307bdf8c919c406d5ed5e81457db84503a3dd48251a",fundebug.releasestage=t.join("-"),window.AppVersion&&(fundebug.appversion=AppVersion.version),function(t){e.get("uid")&&(fundebug.user={uid:e.get("uid")}),fundebug.notifyError(t)}}]),function(e){function t(e,t,n){var r=e[t];e[t]=n(r)}function n(e){return"function"!=typeof e?e:(e.__injected__||(e.__injected__=function(){try{return e.apply(this,arguments)}catch(e){throw u(e),N=!0,e}}),e.__injected__)}function r(e){var t=/^[0-9a-z]{64}$/i;return!(!e||!e.match(t))}function a(e){return e?{name:e&&e.name,message:e&&e.message,fileName:e&&e.fileName||e&&e.sourceURL,lineNumber:e&&e.lineNumber||e&&e.line,columnNumber:e&&e.columnNumber||e&&e.column}:null}function i(){var e;try{throw new Error("")}catch(t){e=t.stack}if(e)return e=e.replace(/(.*?)fundebug(.*?)\.js(.*)\n?/gm,""),e=e.replace(/^Error\n/g,""),e="generated-stack:\n"+e}function o(){for(var e,t=[],n=arguments.callee.caller.caller;n&&t.length<10;){var r=n.toString().match(/function\s*([\w\_$]+)?\s*\(/i);e=r&&r[1]||"[anonymous]",t.push(e),n=n.caller}return"generated-stack:\n"+t.join("\n")}function u(e){if(e){var t=e.stack;t=t.replace(/(.*?)fundebug(.*?)\.js(.*)\n?/gm,"");var n=a(e);h({name:n.name||"uncaught error",message:n.message,fileName:n.fileName,lineNumber:n.lineNumber,columnNumber:n.columnNumber,stacktrace:t,severity:"error",type:"uncaught"})}}function s(e){var t=[];for(var n in e)if(e.hasOwnProperty(n)){var r='"'+n+'":',a=e[n];a&&("object"==typeof a?r+=s(a):"number"==typeof a?r+=a:r=r+'"'+a.replace(/\n/g,"\\n")+'"',t.push(r))}return"{"+t.join(",")+"}"}function c(t){var n,r=(n=t.target?t.target:t.srcElement)&&n.outerHTML;r&&r.length>200&&(r=r.slice(0,200));var a={type:"resourceError",target:{outerHTML:r,src:n&&n.src,tagName:n&&n.tagName,id:n&&n.id,className:n&&n.className,name:n&&n.name,type:n&&n.type,XPath:l(n),selector:m(n)}};if(n.src!==e.location.href&&(!n.src||!n.src.match(/.*\/(.*)$/)||n.src.match(/.*\/(.*)$/)[1])&&a.target.src&&e.XMLHttpRequest){var i=new XMLHttpRequest;i.Fundebug=!0,i.open("HEAD",a.target.src),i.send(),i.onload=function(e){200!==e.target.status&&(a.target.status=e.target.status,a.target.statusText=e.target.statusText),h(a)}}}function l(e){for(var t=[];e&&e.nodeType==Node.ELEMENT_NODE;e=e.parentNode){var n,r=0,a=!1;for(n=e.previousSibling;n;n=n.previousSibling)n.nodeType!=Node.DOCUMENT_TYPE_NODE&&n.nodeName==e.nodeName&&++r;for(n=e.nextSibling;n&&!a;n=n.nextSibling)n.nodeName==e.nodeName&&(a=!0);var i=(e.prefix?e.prefix+":":"")+e.localName,o=r||a?"["+(r+1)+"]":"";t.splice(0,0,i+o)}return t.length?"/"+t.join("/"):null}function m(e){for(var t=[];e.parentNode;){if(e.id){t.unshift("#"+e.id);break}if(e==e.ownerDocument.documentElement)t.unshift(e.tagName);else{for(var n=1,r=e;r.previousElementSibling;r=r.previousElementSibling,n++);t.unshift(e.tagName+":nth-child("+n+")")}e=e.parentNode}return t.join(" > ")}function d(e){w.push(e),w.length>20&&w.shift()}function f(t){var n,r=(n=t.target?t.target:t.srcElement)&&n.outerHTML;r&&r.length>200&&(r=r.slice(0,200)),d({type:"click",page:{url:e.location.href,title:document.title},detail:{outerHTML:r,tagName:n&&n.tagName,id:n&&n.id,className:n&&n.className,name:n&&n.name},time:(new Date).getTime()})}function p(e,t){L=t,d({type:"navigation",detail:{from:e,to:t},time:(new Date).getTime()})}function g(e){return!(b.silentHttp||0===e.detail.status&&/^(app\/|data:text\/html|file:\/\/\/)/.test(e.detail.url)||2===parseInt(e.detail.status/100))}function h(t){if(r(E.getAttribute("apikey")||b.apikey)&&b.maxEventNumber&&!b.silent){b.maxEventNumber-=1;var n={notifierVersion:"0.1.9",userAgent:e.navigator.userAgent,locale:e.navigator.language||e.navigator.userLanguage,url:e.location.href,title:document.title,appVersion:E.getAttribute("appversion")||b.appversion,apiKey:E.getAttribute("apikey")||b.apikey,releaseStage:E.getAttribute("releasestage")||b.releasestage,metaData:t.metaData||b.metaData,user:t.user||b.user,name:t.name,time:(new Date).getTime(),message:t.message,fileName:t.fileName,lineNumber:t.lineNumber,columnNumber:t.columnNumber,stacktrace:t.stacktrace,type:t.type,severity:t.severity,target:t.target,req:t.req,res:t.res,breadcrumbs:w};n.userAgent&&n.userAgent.match(/Googlebot/)||v(n)}}function v(t){var n;if(n="undefined"==typeof JSON?s(t):JSON.stringify(t),e.XMLHttpRequest&&e.atob){var r=new XMLHttpRequest;r.Fundebug=!0,r.open("POST","https://fundebug.com/javascript/"),r.setRequestHeader("Content-Type","application/json"),r.send(n)}else(new Image).src=y+"?event="+encodeURIComponent(n)}var y="https://fundebug.com/javascript/",b={};e.fundebug=b;var N=!1,E=function(){var e=document.currentScript;if(!e){var t=document.scripts;e=t[t.length-1]}return e}();b.silent=E.getAttribute("silent")||!1,b.maxEventNumber=E.getAttribute("maxEventNumber")||10,b.silentResource=E.getAttribute("silentResource")||!1,b.silentHttp=E.getAttribute("silentHttp")||!1,t(e,"onerror",function(){return function(t,n,r,i,u){if(N)N=!1;else{void 0===i&&e.event&&(i=e.event.errorCharacter);var s;s=n&&n!==e.location.href?n:null;var c=a(u);h({message:t,lineNumber:r,columnNumber:i,fileName:s||c&&c.fileName,name:c&&c.name||"uncaught error",stacktrace:u&&u.stack||o(),severity:"error",type:"uncaught"})}}});var T=!0;if(e.atob){if(e.ErrorEvent)try{e.ErrorEvent.prototype.hasOwnProperty("error")&&(T=!1)}catch(e){}}else T=!1;"EventTarget Window Node ApplicationCache AudioTrackList ChannelMergerNode CryptoOperation EventSource FileReader HTMLUnknownElement IDBDatabase IDBRequest IDBTransaction KeyOperation MediaController MessagePort ModalWindow Notification SVGElementInstance Screen TextTrack TextTrackCue TextTrackList WebSocket WebSocketWorker Worker XMLHttpRequest XMLHttpRequestEventTarget XMLHttpRequestUpload".replace(/\w+/g,function(r){if(T){var a=e[r]&&e[r].prototype;a&&a.hasOwnProperty&&a.hasOwnProperty("addEventListener")&&(t(a,"addEventListener",function(e){return function(t,r,a,i){return r&&r.handleEvent&&(r.handleEvent=n(r.handleEvent)),e.call(this,t,n(r),a,i)}}),t(a,"removeEventListener",function(e){return function(t,r,a){return e.call(this,t,r,a),e.call(this,t,n(r),a)}}))}}),b.notify=function(e,t,n){if(e)return h({name:e||n&&n.name,message:t||n&&n.message,severity:n&&n.message||"warning",stacktrace:i(),type:"notification",user:n&&n.user,metaData:n&&n.metaData}),"fundebug.com"===location.host?"äº²ï¼Œä¸è¦åœ¨Fundebugç½‘ç«™æµ‹è¯•å“¦ï¼›è¯·å°†Fundebugæ’ä»¶é›†æˆåˆ°æ‚¨çš„ç½‘ç«™ï¼Œç„¶åŽè¿›è¡Œæµ‹è¯•!":"è¯·æŸ¥çœ‹é‚®ç®±ä»¥åŠFundebugæŽ§åˆ¶å°!"},b.notifyError=function(e,t){if(e){var n=a(e);h({name:n.name||t&&t.name||"caught error",message:n.message||t&&t.message,stacktrace:e.stack,fileName:n.fileName,lineNumber:n.lineNumber,columnNumber:n.columnNumber,severity:t&&t.severity||"error",type:"caught",user:t&&t.user,metaData:t&&t.metaData})}},b.notifyHttpError=function(e,t,n){h({type:"httpError",req:e,res:t,user:n&&n.user,metaData:n&&n.metaData})},e.addEventListener&&e.addEventListener("unhandledrejection",function(e){b.notifyError(e.reason)}),e.addEventListener&&e.addEventListener("error",c,!0);var w=[];e.addEventListener?e.addEventListener("click",f,!0):document.attachEvent("onclick",f);var L={url:e.location.href};document.addEventListener?document.addEventListener("DOMContentLoaded",function(){L={url:e.location.href,title:document.title}}):document.attachEvent("onreadystatechange",function(){L={url:e.location.href,title:document.title}});var k=e.onpopstate;e.onpopstate=function(){var t={url:e.location.href};if(L.title||(L.title=document.title),L.url!==t.url&&p(L,t),k)return k.apply(this,arguments)};var x=e.history.pushState;e.history.pushState=function(){L={url:e.location.href,title:document.title};var t={};if(3===arguments.length&&(t.url=arguments[2]),L.url!==t.url&&p(L,t),x)return x.apply(this,arguments)};var D=e.onhashchange;if(e.onhashchange=function(){var t={url:e.location.href,title:document.title};if(L.url!==t.url&&p(L,t),D)return D.apply(this,arguments)},e.XMLHttpRequest){var H=XMLHttpRequest.prototype;if(!H)return;var M,R,S=H.open,A=H.send;H.open=function(e,t){return M=e,R=t,S.apply(this,arguments)},H.send=function(){var t=this,n=t.onreadystatechange;return t.onreadystatechange=function(){if(4===t.readyState&&!t.Fundebug&&R!=y){var r={type:"XMLHttpRequest",page:{url:e.location.href},detail:{method:M,url:t.responseURL||R,status:t.status,statusText:t.statusText},time:(new Date).getTime()};if(g(r)){var a={method:r.detail.method,url:r.detail.url},i={status:t.status,statusText:t.statusText,response:t.response};b.notifyHttpError(a,i)}d(r)}n&&n.apply(this,arguments)},A.apply(this,arguments)}}if(e.fetch){var O=e.fetch;e.fetch=function(t,n){return O.apply(this,arguments).then(function(t){var r={type:"fetch",page:{url:e.location.href,title:document.title},detail:{method:n&&n.method||"GET",url:t.url,status:t.status,statusText:t.statusText},time:(new Date).getTime()};if(g(r)){var a={method:r.detail.method,url:r.detail.url},i={status:t.status,statusText:t.statusText};b.notifyHttpError(a,i)}return d(r),t})}}var _="function"==typeof define,j="undefined"!=typeof module&&module.exports;_?define(b):j&&(module.exports=b)}(window);
"use strict";angular.module("app").run(["$ionicPlatform","$ionicPopup","$jpush",function(e,i,t){!window.isPRODUCTION&&e.on("resume",t.clear),document.addEventListener("jpush.openNotification",function(e){i.alert({title:"openNotification",template:JSON.stringify(e)}),t.clear()},!1),document.addEventListener("jpush.receiveNotification",function(e){i.alert({title:"receiveNotification",template:JSON.stringify(e)}),t.clear()},!1),document.addEventListener("jpush.receiveMessage",function(e){i.alert({title:"receiveMessage",template:JSON.stringify(e)}),t.clear()},!1)}]),angular.module("app").service("$jpush",["$ionicPopup","$storage",function(e,i){var t,n=this;angular.extend(n,{clear:function(){window.isAndroid&&t.clearAllNotification(),window.isIOS&&(t.resetBadge(),t.setApplicationIconBadgeNumber(0))},setAlias:function(i,n,a){return e.alert({title:"alias",template:i}),t.setAlias(i,n||angular.noop,a||angular.noop)}}),window.isPRODUCTION?t={}:((t=window.plugins&&window.plugins.jPushPlugin).init(),!i.expired()&&n.setAlias(i.get("uid")))}]);
"use strict";angular.module("app").service("$storage",["$cookies",function(e){var t=this,n="__emapp_",o=window.isPRODUCTION?".cloudenergy.me":location.hostname,i={uid:"",token:""},r=e.getAll(),a=new window.Hashes.SHA1,s=function(e,t){var n=[],o=[];return angular.forEach(e,function(e,t){n.push(t)}),n.sort(),angular.forEach(n,function(t){o.push(t+"="+encodeURIComponent(angular.isObject(e[t])?JSON.stringify(e[t]):e[t]))}),t+o.toString().replace(/,/g,"")+t};angular.extend(t,{get:function(o){return o=t.expired()?void 0:e.get(o)||sessionStorage[n+o]||localStorage[n+o],"undefined"===o?void 0:o},set:function(r,a,s){r?Object.keys(r).length&&(!s&&Object.keys(i).map(function(t){e.put(t,r[t],{path:"/",domain:o,expires:a&&moment().add(10,"Y")._d||void 0})}),a?(t.expired(moment().add(10,"Y").unix()),Object.keys(i).map(function(e){localStorage[n+e]=r[e]})):(sessionStorage[n+"expires"]="Session",Object.keys(i).map(function(e){sessionStorage[n+e]=r[e]}))):(delete localStorage[n+"expires"],delete sessionStorage[n+"expires"],Object.keys(i).map(function(t){delete localStorage[n+t],delete sessionStorage[n+t],e.remove(t,{path:"/",domain:o})}))},expired:function(t){if(!t||!moment(t,"X"))return!e.get("token")&&(!sessionStorage[n+"expires"]&&(!(t=localStorage[n+"expires"])||moment(t,"X").isBefore(moment())));localStorage[n+"expires"]=t},valid:function(){var e=!0;return Object.keys(i).map(function(n){t.get(n)||(e=!1)}),e},encrypt:function(e){if(t.valid()){var n=moment().unix();e.v=n,e.t=t.get("token"),e.sign=a.hex(s(e,a.hex(n.toString()))),e.p=t.get("uid"),delete e.t}return e}}),Object.keys(r).length&&t.set(r,!1,!0)}]);
"use strict";angular.module("app").service("User",["$rootScope","$q","$cookies","$ionicPlatform","$ionicPopup","$api","$jpush","$storage",function(e,t,n,r,o,s,i,u){var a={};angular.extend(e.User=this,{data:void 0,$userinfo:function(n){var r=t.defer();return s.business.userinfo(n||{},function(t){/^USER$/.test(t.result.character._id)?(e.User.data=a=angular.extend(a,t.result),r.resolve(t)):(u.set(null),r.reject({code:90000009}))},function(e){u.set(null),r.reject(e)}),r.promise},$login:function(n){n=n||{};var r=t.defer();return s.auth.login(n,function(t){u.set(a=t.result,!0),e.User.$userinfo().then(function(e){!window.isPRODUCTION&&i.setAlias(a.uid),r.resolve(e)},function(e){u.set(null),r.reject(e)})},r.reject),r.promise},$logout:function(t){return s.auth.logout(t||{},function(){delete e.User.data,u.set(null),!window.isPRODUCTION&&i.setAlias("")}).$promise}})}]);