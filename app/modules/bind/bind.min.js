"use strict";angular.module("app").controller("app.bind",["$cookies","$location","$state","$stateParams","$ionicHistory","$ionicLoading","$api","User","ERRORCODE",function(e,i,o,a,n,s,r,d,l){this.submit=function(t){return t.user?t.password?(t.onsubmit=!0,void r.account.wxbind({uid:t.user,passwd:t.password,openid:a.openid||e.get("openid"),platformid:a.platformid||e.get("platformid")},function(){d.$login({user:t.user,passwd:(new window.Hashes.MD5).hex(t.password).toUpperCase()}).then(function(){delete t.onsubmit,n.clearHistory(),n.clearCache().then(function(){a.target&&"/m/bind"!==decodeURIComponent(a.target)?i.url(a.target).replace():o.go("app.index",{},{location:"replace"})})},function(e){delete t.onsubmit,s.show({template:'<i class="ion-alert-circled"></i> '+(l[e.code]||e.message||"登录失败"),duration:2e3})})},function(e){delete t.onsubmit,s.show({template:'<i class="ion-alert-circled"></i> '+(l[e.code]||e.message||"绑定失败"),duration:2e3})})):s.show({template:'<i class="ion-android-alert"></i> 密码不能为空',duration:2e3}):s.show({template:'<i class="ion-android-alert"></i> 帐号不能为空',duration:2e3})},this.lost=function(){s.show({template:'<i class="ion-android-alert"></i> 请联系相关物业',duration:2e3})}}]);