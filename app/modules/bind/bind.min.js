"use strict";angular.module("app").controller("app.bind",["$location","$state","$stateParams","$ionicHistory","$ionicLoading","$api","User","ERRORCODE",function(e,t,i,a,o,n,s,r){this.submit=function(d){return d.user?d.password?(d.onsubmit=!0,void n.account.wxbind({uid:d.user,passwd:d.password,openid:i.openid,platformid:i.platformid},function(){s.$login({user:d.user,passwd:(new Hashes.MD5).hex(d.password).toUpperCase()}).then(function(){a.clearHistory(),a.clearCache().then(function(){i.target&&"/m/bind"!==decodeURIComponent(i.target)?e.url(i.target).replace():t.go("app.index",{},{location:"replace"})})},function(e){delete d.onsubmit,o.show({template:'<i class="ion-alert-circled"></i> '+(r[parseInt(e.code)]||e.message||"登录失败"),duration:2e3})})},function(e){delete d.onsubmit,o.show({template:'<i class="ion-alert-circled"></i> '+(r[parseInt(e.code)]||e.message||"绑定失败"),duration:2e3})})):o.show({template:'<i class="ion-android-alert"></i> 密码不能为空',duration:1e3}):o.show({template:'<i class="ion-android-alert"></i> 帐号不能为空',duration:1e3})}}]);