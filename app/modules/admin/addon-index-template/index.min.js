"use strict";angular.module("app").component("adminAddonIndexTemplate",{templateUrl:"app/modules/admin/addon-index-template/index.html?rev=6ffa10ef86",bindings:{project:"<"},controller:["$mdDialog","$ocLazyLoad","$api","Dialog",function(e,t,n,a){var l=this;angular.extend(l,{$onInit:function(){l.templates.selected=l.templates[0]},$onChanges:function(e){e.project&&e.project.currentValue&&l.templateInfo()},templates:[{id:1,name:"默认（天气、主应用、第三方应用）",url:"addon-index-tmpl-default.html"}],templateInfo:function(){n.apptemplate.info({project:l.project._id},function(e){l.template=e.result.content&&angular.fromJson(e.result.content)||{},l.template.icons&&t.load(l.template.icons)},function(){l.template={}})},detail:function(t,n,a){l.template[n]=l.template[n]||[],e.show({targetEvent:t,fullscreen:!0,clickOutsideToClose:!0,locals:{app:a},templateUrl:"app/modules/admin/addon-index-template/detail.html?rev=0cb7aed1cf",controllerAs:"$ctrl",controller:["app",function(t){angular.extend(this,{app:t||{},basic:"basic"===n,submit:e.hide,cancel:e.cancel})}]}).then(function(e){!a&&l.template[n].push(e),l.update()})},update:function(){l.template.icons&&t.load(l.template.icons),n.apptemplate.update({project:l.project._id,template:l.templates.selected.url,content:angular.toJson(l.template)})},remove:function(e,t){angular.forEach(l.template[t],function(e){!e.delete&&this.push(e)},l.template[t]=[]),l.update()},delete:function(e){a.confirm({targetEvent:e,title:"确定要清空该项目的配置吗？"}).then(function(){n.apptemplate.delete({project:l.project._id}).$promise.finally(function(){l.template={}})})}})}]});