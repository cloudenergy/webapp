"use strict";angular.module("app").controller("app.device_month",["$scope","$state","$stateParams","$api",function(t,e,n,s){if(!n.id)return e.go("app.device");var o=this,i=/(\d{4})(\d{2})/.exec(n.month);o.id=n.id,o.month=n.month,t.$on("$ionicView.enter",function(){s.business.timequantumstatistic({deviceid:o.id,time:o.month},function(t){o.options={chart:{type:"column"},xAxis:{categories:[]},yAxis:{title:!1},title:{text:t.result.sum+" <small>(度)</small>",useHTML:!0},tooltip:{headerFormat:'<span style="font-size: 10px">'+i[1]+"-"+parseInt(i[2])+"-{point.key}</span><br/>",pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b> ({point.percentage:.0f}%)<br/>',shared:!0},legend:{labelFormatter:function(){return{"上班":"上班 ("+t.result.onDutyPercent+"%)","下班":"下班 ("+t.result.offDutyPercent+"%)"}[this.name]}},plotOptions:{column:{stacking:"normal"}},series:[{name:"上班",data:[]},{name:"下班",data:[]}]},angular.forEach(t.result.usage,function(t,e){o.options.xAxis.categories.push(moment(e/1e3,"X").date()),o.options.series[0].data.push(t.onDuty),o.options.series[1].data.push(t.offDuty)})})})}]);