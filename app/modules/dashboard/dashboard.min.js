"use strict";angular.module("app").component("dashboard",{templateUrl:"app/modules/dashboard/dashboard.html?rev=8a266137bf",controller:["$element","$rootScope","$timeout","$mdBottomSheet","$mdSidenav","$state","$localStorage","$sessionStorage","$api","MENUCONFIG",function(e,t,n,o,a,c,i,d,r,l){var s,u=this;angular.extend(u,{$onInit:function(){n(function(){u.sidenav=a("sidenav").onClose(function(){delete t.sidenavLocked}),t.$watch("sidenavLocked",function(e){u.locked=e,e?u.sidenav.open():u.sidenav.isOpen()&&u.sidenav.close()}),t.$watch("Project.selected",function(e){u.Project&&e&&(i.project_selected=e._id,c.reload(c.prev.state,c.prev.params,{reload:!0}))}),t.$watch("UserInfo",function(e){e?(u.client=d.client,u.isLogin=!0,u.UserInfo=e,angular.forEach(l,function(t){e.character.level<=t.character.level&&t.client[d.client]&&this.push(t)},u.sideMenu=[]),u.toggleSidemenu(c.current.name),"WEB"===u.client&&(u.Project=t.Project,r.account.info({id:e.uid},function(e){u.Account=e.result||{}})),u.renderTitle(c.$current)):(delete t.sidenavLocked,delete u.client,delete u.isLogin,delete u.UserInfo,delete u.Project,delete u.Account,delete u.sideMenu)}),t.$watch("HttpRequestInProgress",function(e){s&&n.cancel(s),e?u.inprogress=!0:s=n(function(){delete u.inprogress},100)}),t.$on("$stateChangeStart",function(){delete t.sidenavLocked,o.hide()}),t.$on("$stateChangeSuccess",function(e,t){u.renderTitle(c.$current),u.toggleSidemenu(t.name)})})},renderTitle:function(e){for("WECHAT"===u.client&&n(function(){var e=document.createElement("iframe");e.style.position="absolute",e.style.zIndex=-1,e.style.width="100%",e.style.height="100%",e.style.background="transparent",e.src="package.json",e.onload=function(){n(function(){document.body.removeChild(e)})},document.body.appendChild(e)}),u.breadcrumbs=[];e;)e.data&&Object.keys(e.data).length&&e.data.title&&u.breadcrumbs.unshift({state:e.abstract?null:e.name,title:e.data.title}),e=e.parent;document.title=u.breadcrumbs.length&&u.breadcrumbs[u.breadcrumbs.length-1].title||"物业中心"},toggleSidemenu:function(e){u.sideMenu&&(u.sideMenu.active=e,u.sideMenu.toggle=/\w+\.\w+/.exec(e)[0])}})}]});