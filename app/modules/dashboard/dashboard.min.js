"use strict";angular.module("app").component("dashboard",{templateUrl:"app/modules/dashboard/dashboard.html?rev=ea02091c4c",controller:["$$rAF","$element","$rootScope","$timeout","$swipe","$animateCss","$mdMedia","$mdSidenav","$state","$sessionStorage","$api","MENUCONFIG",function(e,t,n,i,a,o,d,s,c,l,r,u){var m,f=this;angular.extend(f,{$onInit:function(){e(function(){f.renderTitle(c.$current),f.sideSwipe(angular.element(t[0].querySelector(".site-sidenav"))),f.sidenav=s("sidenav").onClose(function(){delete n.sidenavLocked}),n.$watch("sidenavLocked",function(e){f.locked=e,e?f.sidenav.open():f.sidenav.isOpen()&&f.sidenav.close()}),n.$watch("UserInfo",function(e){e?(f.isLogin=!0,f.UserInfo=e,r.account.info({id:e.uid},function(e){f.Account=e.result||{},angular.forEach(u,function(e){f.Account.character.level<=e.character.level&&e.client[l.client]&&this.push(e)},f.sideMenu=[]),f.toggleSidemenu(c.current.name)}),f.WECHAT="WECHAT"===l.client):(delete n.sidenavLocked,delete f.isLogin,delete f.UserInfo,delete f.Account,delete f.sideMenu,delete f.WECHAT)}),n.$watch("HttpRequestInProgress",function(e){m&&i.cancel(m),e?f.inprogress=!0:m=i(function(){delete f.inprogress},100)}),n.$on("$stateChangeSuccess",function(e,t){f.renderTitle(c.$current),f.toggleSidemenu(t.name),delete n.sidenavLocked})})},openSidenav:function(){n.sidenavLocked=!0},renderTitle:function(e){for(document.title=e.data&&e.data.title||"物业中心",i(function(){var e=document.createElement("iframe");e.style.position="absolute",e.style.zIndex=-1,e.style.width="100%",e.style.height="100%",e.style.background="transparent",e.src="app/components/sidemenu/sidemenu.html?rev=ecc0a6c4cb",e.onload=function(){i(function(){document.body.removeChild(e)})},document.body.appendChild(e)}),f.breadcrumbs=[];e;)e.data&&Object.keys(e.data).length&&e.data.title&&f.breadcrumbs.unshift({state:e.abstract?null:e.name,title:e.data.title}),e=e.parent},sideSwipe:function(t){var i=0,s=0;a.bind(t,{start:function(e){d("gt-sm")||(i=e.x,s=t[0].clientWidth)},move:function(e){!d("gt-sm")&&t.css({left:-Math.max(0,i-e.x)})},end:function(a){d("gt-sm")||(i=(i-a.x)/s<.33?0:"-100%",o(t,{easing:"ease-in-out",to:{left:i},duration:.33}).start().then(function(){i&&(t.addClass("visibility-hidden"),delete n.sidenavLocked,e(function(){t.removeClass("visibility-hidden")})),e(function(){t.removeAttr("style")})}))}})},toggleSidemenu:function(e){f.sideMenu&&(f.sideMenu.active=e,f.sideMenu.toggle=/\w+\.\w+/.exec(e)[0])}})}]});