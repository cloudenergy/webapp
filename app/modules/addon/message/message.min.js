"use strict";angular.module("app").component("addonMessage",{templateUrl:"app/modules/addon/message/message.html?rev=dbffe9d1a3",controller:["$$rAF","$element","$api","$swipe","$timeout","User",function(t,e,n,a,o,i){var g,l=this;angular.extend(l,{$onInit:function(){l.loadList()},paging:{count:0,pageindex:0,pagesize:30,unload:!0},list:[],loadList:function(){(l.paging.unload||l.list.length<l.paging.count&&!l.paging.loading)&&(delete l.paging.unload,l.paging.loading=!0,n.business.recentchargelog({project:[{id:i.data.project}],from:moment().subtract(12,"month").format("YYYYMMDD"),to:moment().format("YYYYMMDD"),status:"SUCCESS",pageindex:l.paging.pageindex+1,pagesize:l.paging.pagesize},function(t){t=t.result[i.data.project]||{},angular.forEach(t.detail||[],function(t){l.list.push(t)}),l.paging=t.paging}))},infiniteItems:{getItemAtIndex:function(t){return t===l.list.length-1&&l.loadList(),l.list[t]},getLength:function(){return l.list.length}},messageType:[{title:"余额不足提醒",bgColor:"deep-orange-300",state:"app.addon.charge",tip1:"点此去充值，如已充值请忽略",tip2:"充值"},{title:"余额不足提醒",bgColor:"red-300",state:"app.addon.charge",tip1:"点此去充值，如已充值请忽略",tip2:"充值"},{title:"充值成功提醒",bgColor:"green-300",state:"app.addon.chargelog",tip1:"点击查看账户余额详情",tip2:"详情"}],deleteMsg:function(t){t.preventDefault(),t.stopPropagation(),console.log(t)},checkLast:function(n){n&&t(function(){l.sideSwipe(angular.element(e[0].querySelectorAll(".tip-delete")))})},sideSwipe:function(t){angular.forEach(t,function(e){var n,i=angular.element(e);a.bind(i.find("a"),{start:function(e,a){n=!1,t.find("button").removeClass("show"),"touchstart"==a.type&&(g=o(function(){i.find("button").addClass("show"),n=!0},800))},cancel:function(){o.cancel(g)},end:function(t,e){o.cancel(g),n&&(e.preventDefault(),e.stopPropagation())}})})}})}]});