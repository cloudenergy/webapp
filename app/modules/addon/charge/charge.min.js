"use strict";angular.module("app").component("addonCharge",{templateUrl:"app/modules/addon/charge/charge.html?rev=22de87044b",controller:["$q","$state","$api","Dialog","User","ERRORCODE",function(e,t,n,a,r,c){var o=this;angular.extend(o,{$onInit:function(){o.UserData=r.data,o.charge.amount=o.amounts[0],n.payment.channelinfo({project:r.data.project,type:{app:["alipay","wx"],wx_pub:["wx_pub"]}.wx_pub,flow:"EARNING"},function(e){o.channels=e.result||[],o.charge.channel=o.channels[0]&&o.channels[0].id||void 0})},wx_pub:!0,amounts:[100,500,1e3,2e3,5e3],charge:{},submit:function(t){var u=[],i=e.defer();return!o.charge.amount&&u.push("请输入正确的金额"),!o.charge.channel&&u.push("暂无可用充值渠道"),u.length?void a.alert({title:"信息不完整",textContent:u.join("，"),targetEvent:t}):(n.payment.charge({project:r.data.project,body:"智慧管家充值",subject:"智慧管家",uid:r.data.uid,amount:o.charge.amount,channelaccountid:o.charge.channel},function(e){pingpp.createPayment(e.result,function(e){"success"===e?i.resolve():i.reject(e||"invalid")})},function(e){i.reject(e.message)}),void i.promise.then(function(){r.userinfo().then(function(e){o.UserData=e}),a.alert({title:"充值成功",targetEvent:t})},function(e){a.alert({title:"充值失败",textContent:c["pingpp_"+e]||e,targetEvent:t})}))}})}]});