"use strict";angular.module("app").component("addonCharge",{templateUrl:"app/modules/addon/charge/charge.html?rev=14e0f66893",controller:["$rootScope","$q","$state","$api","Dialog","User","ERRORCODE",function(e,t,a,n,r,c,o){var i=this;angular.extend(i,{$onInit:function(){i.UserData=c.data,i.charge.amount=i.amounts[0],n.payment.channelinfo({project:c.data.project,type:{APP_ANDROID:["alipay","wx"],APP_IOS:["alipay","wx"],WEB:["alipay_pc_direct","alipay_qr","alipay_wap","wx_pub_qr","wx_wap"],WECHAT:["wx_pub"]}[e.client],flow:"EARNING"},function(e){i.channels=e.result||[],i.charge.channel=i.channels[0]&&i.channels[0].id||void 0})},amounts:[100,500,1e3,2e3,5e3],charge:{},submit:function(e){var a=[],l=t.defer();return!i.charge.amount&&a.push("请输入正确的金额"),!i.charge.channel&&a.push("暂无可用充值渠道"),a.length?void r.alert({title:"信息不完整",textContent:a.join("，"),targetEvent:e}):(n.payment.charge({project:c.data.project,body:"智慧管家充值",subject:"智慧管家",uid:c.data.uid,amount:i.charge.amount,channelaccountid:i.charge.channel},function(e){pingpp.createPayment(e.result,function(e){"success"===e?l.resolve():l.reject(e||"invalid")})},function(e){l.reject(e.message)}),void l.promise.then(function(){c.userinfo().then(function(e){i.UserData=e}),r.alert({title:"充值成功",targetEvent:e})},function(t){r.alert({title:"充值失败",textContent:o["pingpp_"+t]||t,targetEvent:e})}))}})}]});