"use strict";angular.module("app").controller("app.recharge",["$scope","$q","$ionicLoading","$state","$api","User",function(e,n,r,a,t,o){var i,u=this,s=document.querySelector("#app_recharge_input_custom");!function(n,r){window.isAndroid&&(n.type="number"),n.onkeydown=function(e){var a=e.keyCode>=48&&e.keyCode<=57,t=229==e.keyCode,o=8==e.keyCode;if(a||t||o){if(window.isAndroid&&t&&/\./.test(n.value))return!1;if(!n.value||/^\d+(\.(\d{1,2})?)?$/.test(n.value))return r=n.value,!0}return!1},n.onkeyup=function(a){u.keyVal=a.keyCode,e.$apply(),n.value&&!/^\d+(\.(\d{1,2})?)?$/.test(n.value)&&(n.value=r)}}(s),e.$on("$ionicView.enter",function(){u.refresh()}),u.refresh=function(n){return o.$userinfo({_inprogress:n}).then(function(){u.UserData=o.data}).finally(function(){angular.isDefined(n)&&e.$broadcast("scroll.refreshComplete")})},angular.extend(u,{custom_min:.01,amounts:[100,500,1e3,2e3,5e3,0],recharge:{amount:100},select:function(e){u.recharge.amount=e,s.value=""},submit:function(){if(i=s.value,!u.recharge.amount&&!i)return r.show({template:'<i class="ion-android-alert"></i> '+(0===u.recharge.amount?"请输入充值金额":"请选择充值金额"),duration:2e3});if(i){if(u.recharge.amount=0,/^-$/.test(i)||!angular.isNumber(parseFloat(i)))return r.show({template:'<i class="ion-android-alert"></i> 充值金额必须为数字',duration:2e3});if(i<u.custom_min)return r.show({template:'<i class="ion-android-alert"></i> 最低充值'+u.custom_min+"元",duration:2e3})}a.go("app.recharge_channel",{amount:u.recharge.amount||i})}})}]);