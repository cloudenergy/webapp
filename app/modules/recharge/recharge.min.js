"use strict";angular.module("app").controller("app.recharge",["$scope","$q","$ionicLoading","$state","$api","User",function(e,n,a,r,t,o){var i,u=this,s=document.querySelector("#app_recharge_input_custom");!function(n,a){window.isAndroid&&(n.type="number");var r=[];n.onkeydown=function(e){r.push(e.key);var t=e.keyCode>=48&&e.keyCode<=57,o=229==e.keyCode,i=8==e.keyCode;return!!(t||o||i)&&((!o||!/\./.test(n.value))&&(/^\d+(\.(\d{1,2})?)?$/.test(n.value)&&(a=n.value),!0))},n.onkeyup=function(){u.keyVal=r.join("|"),e.$apply(),n.value&&!/^\d+(\.(\d{1,2})?)?$/.test(n.value)&&(n.value=a)}}(s),e.$on("$ionicView.enter",function(){u.refresh()}),u.refresh=function(n){return o.$userinfo({_inprogress:n}).then(function(){u.UserData=o.data}).finally(function(){angular.isDefined(n)&&e.$broadcast("scroll.refreshComplete")})},angular.extend(u,{custom_min:.01,amounts:[100,500,1e3,2e3,5e3,0],recharge:{amount:100},select:function(e){u.recharge.amount=e,s.value=""},submit:function(){if(i=s.value,!u.recharge.amount&&!i)return a.show({template:'<i class="ion-android-alert"></i> '+(0===u.recharge.amount?"请输入充值金额":"请选择充值金额"),duration:2e3});if(i){if(u.recharge.amount=0,/^-$/.test(i)||!angular.isNumber(parseFloat(i)))return a.show({template:'<i class="ion-android-alert"></i> 充值金额必须为数字',duration:2e3});if(i<u.custom_min)return a.show({template:'<i class="ion-android-alert"></i> 最低充值'+u.custom_min+"元",duration:2e3})}r.go("app.recharge_channel",{amount:u.recharge.amount||i})}})}]);