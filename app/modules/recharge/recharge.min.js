"use strict";angular.module("app").component("recharge",{templateUrl:"app/modules/recharge/recharge.html?rev=83ee7ec5ba",controller:["$q","$api","Dialog","User","ERRORCODE",function(e,t,a,n,r){var c=this;angular.extend(c,{$onInit:function(){c.UserData=n.data,c.recharge.amount=c.amounts[0],t.payment.channelinfo({project:n.data.project,type:{APP_ANDROID:["alipay","wx"],APP_IOS:["alipay","wx"],WEB:["alipay_pc_direct","alipay_qr","alipay_wap","wx_pub_qr","wx_wap"],WECHAT:["wx_pub"]}[n.client],flow:"EARNING"},function(e){c.channels=e.result,c.recharge.channel=c.channels[0]&&c.channels[0].id||void 0})},amount_min:100,amounts:[100,500,1e3,2e3,5e3],recharge:{},submit:function(i){var o=[],l=e.defer();return!c.recharge.amount&&o.push("请输入正确的金额"),!c.recharge.channel&&o.push("暂无可用充值渠道"),o.length?void a.alert({title:"信息不完整",textContent:o.join("，"),targetEvent:i}):(t.payment.charge({project:n.data.project,body:"智慧管家充值",subject:"智慧管家",uid:n.data.uid,amount:c.recharge.amount,channelaccountid:c.recharge.channel},function(e){pingpp.createPayment(e.result,function(e){"success"===e?l.resolve():l.reject(e||"invalid")})},function(e){l.reject(e.message)}),void l.promise.then(function(){n.$userinfo().then(function(e){c.UserData=e}),a.alert({title:"充值成功",targetEvent:i})},function(e){a.alert({title:"充值失败",textContent:r["pingpp_"+e]||e,targetEvent:i})}))}})}]});