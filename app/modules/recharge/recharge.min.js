"use strict";angular.module("app").controller("app.recharge",["$scope","$q","$ionicLoading","$state","$api","User",function(e,n,r,t,a,o){var i,u=this,s=document.querySelector("#app_recharge_input_custom");!function(e,n){window.isAndroid&&(e.type="number"),e.onkeydown=function(r){var t=r.keyCode>=48&&r.keyCode<=57,a=229==r.keyCode,o=8==r.keyCode;if(t||a||o){if(a&&/\./.test(e.value))return!1;if(!e.value||/^\d+(\.(\d{1,2})?)?$/.test(e.value))return n=e.value,!0}return!1},e.onkeyup=function(){e.value&&!/^\d+(\.(\d{1,2})?)?$/.test(e.value)&&(e.value=n)}}(s),e.$on("$ionicView.enter",function(){u.refresh()}),u.refresh=function(n){return o.$userinfo({_inprogress:n}).then(function(){u.UserData=o.data}).finally(function(){angular.isDefined(n)&&e.$broadcast("scroll.refreshComplete")})},angular.extend(u,{custom_min:.01,amounts:[100,500,1e3,2e3,5e3,0],recharge:{amount:100},select:function(e){u.recharge.amount=e,s.value=""},submit:function(){if(i=s.value,!u.recharge.amount&&!i)return r.show({template:'<i class="ion-android-alert"></i> '+(0===u.recharge.amount?"请输入充值金额":"请选择充值金额"),duration:2e3});if(i){if(u.recharge.amount=0,/^-$/.test(i)||!angular.isNumber(parseFloat(i)))return r.show({template:'<i class="ion-android-alert"></i> 充值金额必须为数字',duration:2e3});if(i<u.custom_min)return r.show({template:'<i class="ion-android-alert"></i> 最低充值'+u.custom_min+"元",duration:2e3})}t.go("app.recharge_channel",{amount:u.recharge.amount||i})}})}]);