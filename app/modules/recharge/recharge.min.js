"use strict";angular.module("app").controller("app.recharge",["$scope","$q","$ionicLoading","$state","$api","User",function(n,a,t,r,o,i){var u,s=this,c=document.querySelector("#app_recharge_input_custom");!function(a,t){window.isAndroid&&(a.type="number");var r=[];a.onkeydown=function(e){r.push(e.key);var n=e.keyCode>=48&&e.keyCode<=57,o=229==e.keyCode,i=8==e.keyCode;return!!(n||o||i)&&((!o||!/\./.test(a.value))&&(/^\d+(\.(\d{1,2})?)?$/.test(a.value)&&(t=a.value),!0))},a.onkeyup=function(){s.keyVal=r.join("|"),n.$apply(),a.value&&!/^\d+(\.(\d{1,2})?)?$/.test(a.value)&&(a.value=t)},a.addEventListener("textInput",function(){var a=e.originalEvent.data.charCodeAt(0);r.push(a),s.keyVal=r.join("|"),n.$apply()},!0)}(c),n.$on("$ionicView.enter",function(){s.refresh()}),s.refresh=function(e){return i.$userinfo({_inprogress:e}).then(function(){s.UserData=i.data}).finally(function(){angular.isDefined(e)&&n.$broadcast("scroll.refreshComplete")})},angular.extend(s,{custom_min:.01,amounts:[100,500,1e3,2e3,5e3,0],recharge:{amount:100},select:function(e){s.recharge.amount=e,c.value=""},submit:function(){if(u=c.value,!s.recharge.amount&&!u)return t.show({template:'<i class="ion-android-alert"></i> '+(0===s.recharge.amount?"请输入充值金额":"请选择充值金额"),duration:2e3});if(u){if(s.recharge.amount=0,/^-$/.test(u)||!angular.isNumber(parseFloat(u)))return t.show({template:'<i class="ion-android-alert"></i> 充值金额必须为数字',duration:2e3});if(u<s.custom_min)return t.show({template:'<i class="ion-android-alert"></i> 最低充值'+s.custom_min+"元",duration:2e3})}r.go("app.recharge_channel",{amount:s.recharge.amount||u})}})}]);